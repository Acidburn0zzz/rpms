--- unixbench-4.0.1.orig/Run	1997-06-21 00:55:32 +0400
+++ unixbench-4.0.1/Run	2003-10-29 16:12:32 +0300
@@ -1,5 +1,11 @@
 #! /bin/sh
 
+HOMEDIR=$HOME
+BINDIR=/usr/lib/unixbench/pgms
+SCRPDIR=/usr/lib/unixbench/pgms
+TESTDIR=/usr/lib/unixbench/testdir
+TMPDIR=$TMPDIR
+
 #################### set your defaults here ##############
 #FLAVOR= # flavor of UNIX: if not determined by script: SysV or BSD
 FULL_SUITE="dhry2reg double syscall pipe context1 spawn execl \
@@ -57,18 +63,7 @@
 #end Jon mods
 umask 022    # at least mortals can read root's files this way
 #
-if [ -z "${FLAVOR-}" ]; then
-	# determine flavor of UNIX from number of lines generated by "time"
-	Fcount=`/usr/bin/time date 2>&1 | wc -l | sed 's/ //g'`
-	case "$Fcount" in
-	2) FLAVOR=BSD ;;
-	3) FLAVOR=Linux ;;
-	5) FLAVOR=SysV ;;
-	*) echo "Flavor of UNIX is not known."
-	   echo "Please define FLAVOR in Run script"
-	   exit;;
-	esac
-fi
+FLAVOR=Linux
 export FLAVOR
 TIME="        %e real        %U user        %S sys"
 export TIME
@@ -80,14 +75,6 @@
 	UNAME="uname -a"
 fi
 
-# check that the required files are in the proper places
-if make check; then
-        :
-else
-	make all
-fi
-
-
 # establish full paths to directories
 _WD=`pwd`
 HOMEDIR=${HOMEDIR-.}
@@ -107,12 +94,8 @@
 SCRPDIR=`pwd`
 cd $_WD
 
-TMPDIR=${HOMEDIR}/tmp
-cd $TMPDIR
-TMPDIR=`pwd`
-cd $_WD
-
-RESULTDIR=${RESULTDIR-${HOMEDIR}/results}
+RESULTDIR=${RESULTDIR-${HOMEDIR}/.unixbench/results}
+[ -d "$RESULTDIR" ] || mkdir -p "$RESULTDIR"
 cd $RESULTDIR
 RESULTDIR=`pwd`
 cd $_WD
@@ -124,7 +107,7 @@
 TESTDIR=`pwd`
 cd $_WD
 
-export BINDIR TMPDIR RESULTDIR PATH TESTDIR TIMEACCUM
+export BINDIR RESULTDIR PATH TESTDIR TIMEACCUM
 #
 cat ${BINDIR}/unixbench.logo # display banner
 rm -f ${TIMEACCUM}      # clean out old time accumulation file
@@ -356,11 +339,10 @@
 	C)  
 		logmsg="C Compiler Throughput"
 		repeat=$shortloop
-		prog="looper ${looper-60} ${CC} cctest.c"
+		prog="looper ${looper-60} ${CC} -o $TMPDIR/a.out cctest.c"
 		stdout=/dev/null
 		repeat="$shortloop"
 		cleanopt="-m $TMPTIMES"
-		rm -f ${TESTDIR}/cctest.o ${TESTDIR}/a.out
 		;;
 
 	arithoh)
@@ -492,7 +474,7 @@
     ########### some specific cleanup routines ##############
     case $bench in
       C)
-      rm -f ${TESTDIR}/cctest.o ${TESTDIR}/a.out
+      rm -f ${TMPDIR}/a.out
       ;;
 
       fstime | fsbuffer | fsdisk)
